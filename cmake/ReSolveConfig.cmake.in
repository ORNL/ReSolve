# Author(s):
# - Ryan Danehy <ryan.danehy@pnnl.gov>


include("${CMAKE_CURRENT_LIST_DIR}/ReSolveTargets.cmake")

include(CheckLanguage)
# This must come before enable_language(CUDA)
if(@RESOLVE_USE_CUDA@)
   set(CMAKE_CUDA_COMPILER @CMAKE_CUDA_COMPILER@)
   enable_language(CUDA)
   check_language(CUDA)
   set(CMAKE_CUDA_FLAGS "@CMAKE_CUDA_FLAGS@")
   find_package(CUDAToolkit REQUIRED)
   add_library(ReSolve::CUDA ALIAS ReSolve::resolve_backend_cuda)
endif()
if(@RESOLVE_USE_HIP@)
  enable_language(HIP)
  check_language(HIP)
  find_package(hip REQUIRED)
  find_package(rocblas REQUIRED)
  find_package(rocsparse REQUIRED)
  # This is just an agly hack to make HIP build work
  get_target_property(hip_includes hip::device INTERFACE_INCLUDE_DIRECTORIES)
  message(STATUS "HIP include directories: ${hip_includes}")
  include_directories(${hip_includes})
  add_library(ReSolve::HIP ALIAS ReSolve::resolve_backend_hip)
endif()

# Compute installation prefix relative to this file.
get_filename_component(_dir "${CMAKE_CURRENT_LIST_FILE}" PATH)
get_filename_component(_prefix "${_dir}/../../.." ABSOLUTE)

# Report other information.
set(ReSolve_INCLUDE_DIRS "${_prefix}/include/")
